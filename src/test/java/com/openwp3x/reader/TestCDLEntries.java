/**
 * 
 */
package com.openwp3x.reader;

import java.net.MalformedURLException;
import java.net.URL;
import java.util.Collection;

import junit.framework.Assert;

import org.junit.Before;
import org.junit.Test;

import com.openwp3x.SourceEntry;
import com.openwp3x.SourcePattern;
import com.openwp3x.SourcePatternFactory;

/**
 * @author marcos.ferreira
 * 
 */
public class TestCDLEntries {

    final URL resource = this.getClass().getClassLoader().getResource("cdl-joinville-list.htm");
    final URL link1 = this.getClass().getClassLoader().getResource("cdl-joinville-n1.htm");
    final URL link2 = this.getClass().getClassLoader().getResource("cdl-joinville-n2.htm");
    SourcePattern entryPattern;
    
    @Before
    public void before() throws MalformedURLException{
    	entryPattern = SourcePatternFactory.getCDLPattern();
    }

    @Test
    public void testGetLinks() throws Exception {
    	entryPattern.setSourceURL(resource);
    	SourceReader newsReader = new SourceReader(entryPattern);
        final Collection<SourceEntry> entries = newsReader.getEntries();
        System.out.println(entries);
        final SourceEntry firstEntry = entries.iterator().next();
        Assert.assertEquals("\n      Invista no seu conhecimento e enriqueça seu currículo!Participe dos cursos oferecidos pela CDL Joinville e…\n    ", firstEntry.getTitle());
        Assert.assertEquals("Invista No Seu Conhecimento E Enriqueça Seu Currículo!participe Dos Cursos Oferecidos Pela Cdl Joinville E…", firstEntry.getFormattedTitle());
        Assert.assertEquals("noticia/11", firstEntry.getUrl());
        Assert.assertEquals("http://www.cdljoinville.com.br/noticia/11", firstEntry.getFormattedURL());
        Assert.assertEquals(4, entries.size());
    }
    
    @Test
    public void testReadLink1() throws MalformedURLException, LinkException{
    	LinkReader linkReader = new LinkReader(entryPattern, link1);
    	LinkEntry linkEntry = linkReader.getLinkEntry();
    	Assert.assertEquals(getExpectedLinkText1(), linkEntry.getLinkText());
    	Assert.assertEquals(getExpectedFormattedLinkText1(), linkEntry.getFormattedLinkText());
    }
    
    private String getExpectedFormattedLinkText1() {
		return "\n   Invista no seu conhecimento e enriqueça seu currículo!Participe dos cursos oferecidos pela CDL Joinville e aprimore seus conhecimentos. São diversos cursos relacionados a área de Vendas, Atendimento ao Cliente e afins. Fique atento a nossa agenda de cursos no link Centro de Treinamento. Invista no seu conhecimento, enriqueça seu currículo e conquiste uma oportunidade no mercado de trabalho! Você Sabia?! A CDL Joinville conta com mais de 2.000 associados e todos tem a oportunidade de divulgar vagas conosco. Há vagas em diversos segmentos, incluindo Shopping e Comércio de Rua. O comércio está valorizando os profissionais que se atualizam e buscam crescimento no ramo. Não perca mais tempo, invista na carreira.Fique atento as VAGAS DISPONÍVEIS em diversas áreas: OPERADORA DE TELEMARKETING: Necessário experiência anterior, acima de 18 anos, feminino. Ensino médio completo/cursando. Horário de segunda a sexta das 09:00 as 15:00. Salário R$ 770,00 + VT.AGENDADORA: Necessário experiência com telemarketing ativo ou receptível. Ensino médiocompleto. Acima de 16 anos. Horário de segunda a sexta das 10:00 as 19:00, sab das 10:00 as 13:00. Salário R$ 940,00 + VT + VR + comissões + benefícios.VENDEDOR INTERNO: para atuar em loja de produtos relacionados a jardinagem, área rural, indústrias e condomínios. Vaga masculina, necessário experiência com vendas (não precisa ser na área), ensino médio completo, acima de 22 anos. Horário de segunda a sexta das 8:15 as 18:00 sábados das 08:15 as 12:15. Salário inicial fixo R$ 940,00 + comissões + VT + VA.VENDEDOR(A) INTERNO: par atuar em loja de calçados no shopping Garten. Não é necessário experiência na função. Ensino médio completo, acima de 18 anos. Horário de segunda a sexta das 14:00 as 22:00, sábados das 12:00 aa 22:00, trabalha dois domingos por mês. Salário R$ 940,00 + comissões + VT +  Plano de Saúde, odontológico e convênio com farmácia.VENDEDOR INTERNO: Para atuar em loja de bebidas, necessário pelo menos um ano de experiência na função (se já tiver trabalhado com bebidas, é melhor ainda) necessita disponibilidade para beber bebidas alcoólicas, masc/fem, acima de 22 anos. Horário de segunda a domingo das 08:00 as 16:20 Folgas por revezamento. Salário inicial fixo R$ 900,00, após três meses R$ 1100,00 + comissões + VT.\n\nSERVIÇOS GERAIS: Para atuar em\nconfecção de moda íntima no bairro Boa Vista, necessário experiência na função\nde pelo menos 6 meses, idade mínima 19 anos de idade. Horário de segunda a\nsexta das 08:00 as 18:00 (na sexta sai as 17:00h); salário inicial R$900,00 +\nVT + VA + convênio farmácia.\n\nCOSTUREIRA: Para atuar em\nconfecção de moda íntima no bairro Boa Vista, necessário experiência na função\nde pelo menos 6 meses, idade mínima 19 anos de idade. Horário de segunda a\nsexta das 08:00 as 18:00 (na sexta sai as 17:00h); salário inicial R$900,00 +\nVT + VA + convênio farmácia.\n\nEXPEDIDORA: Para atuar em\nconfecção de moda íntima no bairro Boa Vista, necessário experiência na função\nde pelo menos 6 meses e conhecimento em informática, idade mínima 19 anos de\nidade. Horário de segunda a sexta das 08:00 as 18:00 (na sexta sai as 17:00h);\nsalário inicial R$850,00 + VT + VA + convênio farmácia.\n\nINSTALADOR/ELETRICISTA: Conhecimentos em elétrica, necessário experiência na função, ensino\nmédio concluído/cursando, acima de 18 anos. Horário de seg. a sex. das 09:00 as\n18:30, sab. das 09:00 as 13:00. Salário inicial R$ 830 (após 3 meses R$\n1.000,00) + VT.\n\nVENDEDOR EXTERNO: Necessário experiência na função, ensino médio completo, não necessita\nveículo próprio, venda de assinaturas de jornal. Horário seg. a sex. 08:00 as\n18:00 e sab. das 08:00 as 12:00. Salário inicial fixo R$ 793,54 (após 3 meses\nR$  940,00) + VT + VR + comissões +\nbenefícios.\n\nOP. DE CAIXA: Necessário experiência na função seja em supermercado, loja, etc. Ensino\nmédio completo e conhecimento em informática, acima de 20 anos. Horário de\nshopping de segunda a as sábado das 14:00 as 22:00 aos domingos das 14:00 as\n20:00. Salário R$ 940,00 + VT + VA + Benefícios.\n\nVENDEDORA INTERNA: irá atuar em loja de calçados; necessário experiência na função (vendas\nno varejo), ensino médio completo. Horário seg. a sex. 09:30 as 19:00 e sab.\ndas 09:30 as 13:00. Salário inicial 940,00 + VT + VR + comissões + benefícios.\n\nAUXILIAR DE VENDAS/ESCRITÓRIO: Candidatas à\nprimeiro emprego. Não é necessário experiência na função,\nensino médio cursando/concluído, a partir de 16 anos, necessita\ndisponibilidade para viagens, feminino. Horário de seg. a sex. das 07:42 as\n18:00. Salário R$ 940,00 + VT + VA + Plano de Saúde.\n\nVENDEDORA INTERNA: irá atuar em loja de móveis alto padrão; necessário experiência na\nfunção, ensino médio completo. Horário seg. a sex. 09:00 as 19:00 e sab. das\n09:00 as 13:00. Salário inicial 940,00 + VT + VR + comissões + benefícios.\n\nOP. CAIXA: irá atuar em loja\nde calçados; necessário experiência na função, ensino médio completo. Horário\nseg. a sex. 09:00 as 18:00 e sab. das 09:00 as 13:00. Salário inicial 940,00 +\nVT + VR + comissões + benefícios.\n\nOP. CAIXA: Shopping Cidade das\nFlores, necessário experiência na função, ensino médio completo, acima de 20\nanos; Horário de segunda a sexta das 16:00 as 22:00, sábados 2X das 10:00 as\n16:00 e 2X das 16:00 as 22:00, domingo das 14:00 as 20:00 (folgas revezadas)\nsalário inicial R$ 820,40 + Qb. de caixa+ VT.\n\nVENDEDORA INTERNA: loja de calçados; necessário experiência na função, ensino médio\ncompleto, acima de 18 de idade. Horário de segunda a sexta das 10:12 as 20:00.\nSalário R$ 940,00 + VT + Comissões.\n\nFACILITADOR DE PRODUÇÃO: possuir experiência com produção, ensino médio completo. Horário de seg.\na sex. das 07:30 as 17:18, salário R$ 1200,00 + VT + almoço na empresa.\n\nOP. DE CAIXA: Necessário experiência anterior como caixa ou similar, ensino médio\ncompleto/cursando, acima de 16 anos de idade. Horário de segunda a sexta das\n08:45 as 18:30, sábado das 08:45 as 13:00. Salário R$ 940,00 + VT + VA + Bônus\npor resultados.\n\nEMPACOTADOR:  para loja de fantasias,\noportunidade para primeiro emprego masculino, não é necessário experiência\nanterior, ensino médio completo/cursando. Horário de segunda a sextas das 13:00\nas 19:00, sábado das 08:45 as 13:00. Salário proporcional às trabalhadas.\n\nVENDEDORA INTERNA: oportunidade para primeiro emprego feminino, não é necessário\nexperiência na função, ensino médio completo/cursando. Horário de segunda a\nsexta das 08:45 as 18:30, sábado das 08:45 as 13:00. Salário R$ 940,00 +\ncomissões + VA + VT.\n\n  Interessados favor comparecer na CDL munidos de currículo,ou enviá-lo via e-mail para: cdltalentos2@cdljoinville.com.brFonte: CDL Talentos\n   ";
	}

	private String getExpectedLinkText1() {
		return "\n   Invista no seu conhecimento e enriqueça seu currículo!Participe dos cursos oferecidos pela CDL Joinville e aprimore seus conhecimentos. São diversos cursos relacionados a área de Vendas, Atendimento ao Cliente e afins. Fique atento a nossa agenda de cursos no link Centro de Treinamento. Invista no seu conhecimento, enriqueça seu currículo e conquiste uma oportunidade no mercado de trabalho! Você Sabia?! A CDL Joinville conta com mais de 2.000 associados e todos tem a oportunidade de divulgar vagas conosco. Há vagas em diversos segmentos, incluindo Shopping e Comércio de Rua. O comércio está valorizando os profissionais que se atualizam e buscam crescimento no ramo. Não perca mais tempo, invista na carreira.Fique atento as VAGAS DISPONÍVEIS em diversas áreas: OPERADORA DE TELEMARKETING: Necessário experiência anterior, acima de 18 anos, feminino. Ensino médio completo/cursando. Horário de segunda a sexta das 09:00 as 15:00. Salário R$ 770,00 + VT.AGENDADORA: Necessário experiência com telemarketing ativo ou receptível. Ensino médiocompleto. Acima de 16 anos. Horário de segunda a sexta das 10:00 as 19:00, sab das 10:00 as 13:00. Salário R$ 940,00 + VT + VR + comissões + benefícios.VENDEDOR INTERNO: para atuar em loja de produtos relacionados a jardinagem, área rural, indústrias e condomínios. Vaga masculina, necessário experiência com vendas (não precisa ser na área), ensino médio completo, acima de 22 anos. Horário de segunda a sexta das 8:15 as 18:00 sábados das 08:15 as 12:15. Salário inicial fixo R$ 940,00 + comissões + VT + VA.VENDEDOR(A) INTERNO: par atuar em loja de calçados no shopping Garten. Não é necessário experiência na função. Ensino médio completo, acima de 18 anos. Horário de segunda a sexta das 14:00 as 22:00, sábados das 12:00 aa 22:00, trabalha dois domingos por mês. Salário R$ 940,00 + comissões + VT +  Plano de Saúde, odontológico e convênio com farmácia.VENDEDOR INTERNO: Para atuar em loja de bebidas, necessário pelo menos um ano de experiência na função (se já tiver trabalhado com bebidas, é melhor ainda) necessita disponibilidade para beber bebidas alcoólicas, masc/fem, acima de 22 anos. Horário de segunda a domingo das 08:00 as 16:20 Folgas por revezamento. Salário inicial fixo R$ 900,00, após três meses R$ 1100,00 + comissões + VT.\n\nSERVIÇOS GERAIS: Para atuar em\nconfecção de moda íntima no bairro Boa Vista, necessário experiência na função\nde pelo menos 6 meses, idade mínima 19 anos de idade. Horário de segunda a\nsexta das 08:00 as 18:00 (na sexta sai as 17:00h); salário inicial R$900,00 +\nVT + VA + convênio farmácia.\n\nCOSTUREIRA: Para atuar em\nconfecção de moda íntima no bairro Boa Vista, necessário experiência na função\nde pelo menos 6 meses, idade mínima 19 anos de idade. Horário de segunda a\nsexta das 08:00 as 18:00 (na sexta sai as 17:00h); salário inicial R$900,00 +\nVT + VA + convênio farmácia.\n\nEXPEDIDORA: Para atuar em\nconfecção de moda íntima no bairro Boa Vista, necessário experiência na função\nde pelo menos 6 meses e conhecimento em informática, idade mínima 19 anos de\nidade. Horário de segunda a sexta das 08:00 as 18:00 (na sexta sai as 17:00h);\nsalário inicial R$850,00 + VT + VA + convênio farmácia.\n\nINSTALADOR/ELETRICISTA: Conhecimentos em elétrica, necessário experiência na função, ensino\nmédio concluído/cursando, acima de 18 anos. Horário de seg. a sex. das 09:00 as\n18:30, sab. das 09:00 as 13:00. Salário inicial R$ 830 (após 3 meses R$\n1.000,00) + VT.\n\nVENDEDOR EXTERNO: Necessário experiência na função, ensino médio completo, não necessita\nveículo próprio, venda de assinaturas de jornal. Horário seg. a sex. 08:00 as\n18:00 e sab. das 08:00 as 12:00. Salário inicial fixo R$ 793,54 (após 3 meses\nR$  940,00) + VT + VR + comissões +\nbenefícios.\n\nOP. DE CAIXA: Necessário experiência na função seja em supermercado, loja, etc. Ensino\nmédio completo e conhecimento em informática, acima de 20 anos. Horário de\nshopping de segunda a as sábado das 14:00 as 22:00 aos domingos das 14:00 as\n20:00. Salário R$ 940,00 + VT + VA + Benefícios.\n\nVENDEDORA INTERNA: irá atuar em loja de calçados; necessário experiência na função (vendas\nno varejo), ensino médio completo. Horário seg. a sex. 09:30 as 19:00 e sab.\ndas 09:30 as 13:00. Salário inicial 940,00 + VT + VR + comissões + benefícios.\n\nAUXILIAR DE VENDAS/ESCRITÓRIO: Candidatas à\nprimeiro emprego. Não é necessário experiência na função,\nensino médio cursando/concluído, a partir de 16 anos, necessita\ndisponibilidade para viagens, feminino. Horário de seg. a sex. das 07:42 as\n18:00. Salário R$ 940,00 + VT + VA + Plano de Saúde.\n\nVENDEDORA INTERNA: irá atuar em loja de móveis alto padrão; necessário experiência na\nfunção, ensino médio completo. Horário seg. a sex. 09:00 as 19:00 e sab. das\n09:00 as 13:00. Salário inicial 940,00 + VT + VR + comissões + benefícios.\n\nOP. CAIXA: irá atuar em loja\nde calçados; necessário experiência na função, ensino médio completo. Horário\nseg. a sex. 09:00 as 18:00 e sab. das 09:00 as 13:00. Salário inicial 940,00 +\nVT + VR + comissões + benefícios.\n\nOP. CAIXA: Shopping Cidade das\nFlores, necessário experiência na função, ensino médio completo, acima de 20\nanos; Horário de segunda a sexta das 16:00 as 22:00, sábados 2X das 10:00 as\n16:00 e 2X das 16:00 as 22:00, domingo das 14:00 as 20:00 (folgas revezadas)\nsalário inicial R$ 820,40 + Qb. de caixa+ VT.\n\nVENDEDORA INTERNA: loja de calçados; necessário experiência na função, ensino médio\ncompleto, acima de 18 de idade. Horário de segunda a sexta das 10:12 as 20:00.\nSalário R$ 940,00 + VT + Comissões.\n\nFACILITADOR DE PRODUÇÃO: possuir experiência com produção, ensino médio completo. Horário de seg.\na sex. das 07:30 as 17:18, salário R$ 1200,00 + VT + almoço na empresa.\n\nOP. DE CAIXA: Necessário experiência anterior como caixa ou similar, ensino médio\ncompleto/cursando, acima de 16 anos de idade. Horário de segunda a sexta das\n08:45 as 18:30, sábado das 08:45 as 13:00. Salário R$ 940,00 + VT + VA + Bônus\npor resultados.\n\nEMPACOTADOR:  para loja de fantasias,\noportunidade para primeiro emprego masculino, não é necessário experiência\nanterior, ensino médio completo/cursando. Horário de segunda a sextas das 13:00\nas 19:00, sábado das 08:45 as 13:00. Salário proporcional às trabalhadas.\n\nVENDEDORA INTERNA: oportunidade para primeiro emprego feminino, não é necessário\nexperiência na função, ensino médio completo/cursando. Horário de segunda a\nsexta das 08:45 as 18:30, sábado das 08:45 as 13:00. Salário R$ 940,00 +\ncomissões + VA + VT.\n\n  Interessados favor comparecer na CDL munidos de currículo,ou enviá-lo via e-mail para: cdltalentos2@cdljoinville.com.brFonte: CDL Talentos\n   ";
	}

	@Test
    public void testReadLink2() throws MalformedURLException, LinkException{
    	LinkReader linkReader = new LinkReader(entryPattern, link2);
    	LinkEntry linkEntry = linkReader.getLinkEntry();
    	Assert.assertEquals(getExpectedLinkText2(), linkEntry.getLinkText());
    	Assert.assertEquals(getExpectedFormattedLinkText2(), linkEntry.getFormattedLinkText());
    }

	private String getExpectedFormattedLinkText2() {
		return "\n   A CDL Joinville, através do presidente Carlos Grendene, dos vice-presidentes José Manoel Ramos e Ivonir Meurer e de lojistas associados, participou da Audiência Pública que discutiu o rebaixamento completo de meio-fio em frente a estabelecimentos comerciais dos bairros de Joinville. Esta reunião foi proposta pelas Comissões de Legislação e de Urbanismo da Câmara de Vereadores de Joinville.Em pauta, estava projeto de lei complementar do vereador Roberto Bisoni. Ele alega que os pequenos comerciantes estão fadados a fechar as portas, porque, sem a possibilidade de rebaixar as calçadas, os clientes não têm onde estacionar e, por consequência, não param no estabelecimento.O presidente da CDL, Carlos Grendene, comentou que é preciso ter uma definição logo, pois já se passaram várias décadas e nada foi definido concretamente.O Poder Executivo, representado na audiência pela Fundação IPPUJ e pelo ITTRAN, abordou aspectos da lei em vigor e como é feita a fiscalização. Hoje, somente é permitido o rebaixo em um espaço pequeno para saída e outro para entrada, sob justificativa de provimento de mais segurança para os pedestres.O debate gerou um debate sobre a falta de fiscalização, uma vez que, segundo o vereador Bisoni, mais de 80% dos estabelecimentos têm alguma irregularidade. Tal argumento foi apoiado pelos vários comerciantes que participaram das discussões.“É preciso analisar o impacto dessa proposta de forma ampla, não só olhando lado do comerciante, mas também dos pedestres, dos portadores de deficiência, da fiscalização do município, e chegar a um ponto que seja a melhor solução para longo prazo, ainda que se não seja possível atender a todos ao mesmo tempo”, afirmou o vereador Manoel Francisco Bento, que já apresentou uma emenda ao projeto.Na opinião do representante do Conselho Municipal dos Direitos da Pessoa com Deficiência de Joinville (Comde), Sérgio Luiz da Silva, já há lei federal que aborda o assunto e que veda o rebaixamento completo do meio-fio. “Se isso ocorrer em Joinville, vamos iniciar uma batalha judicial contra o município, porque não é sensato que ignoremos solemente uma lei maior”, advertiu.Além disso, o argumento do Comde veio no sentido de que o rebaixamento, ainda que não dificulte o acesso das pessoas, aumentará os riscos de colisões dos automóveis em marcha à ré com os cadeirantes ou as crianças que estiverem passando, uma vez que suas alturas dificultariam a observação pelo retrovisor; questão de segurança.O encontro serviu para que a opinião popular pudesse guiar os vereadores das comissões de Legislação e de Urbanismo rumo a um parecer favorável ou contrário. Ainda que divergentes, especialmente entre comerciantes e Comde, a tendência é de aprovação, uma vez que está acostado ao projeto um abaixo-assinado com cerca de 2.000 assinaturas de apoio. Ainda não há data para sua deliberação em plenário da Câmara de Vereadores de Joinville. Fonte: Ascom CDL\n   ";
	}

	private String getExpectedLinkText2() {
		return "\n   A CDL Joinville, através do presidente Carlos Grendene, dos vice-presidentes José Manoel Ramos e Ivonir Meurer e de lojistas associados, participou da Audiência Pública que discutiu o rebaixamento completo de meio-fio em frente a estabelecimentos comerciais dos bairros de Joinville. Esta reunião foi proposta pelas Comissões de Legislação e de Urbanismo da Câmara de Vereadores de Joinville.Em pauta, estava projeto de lei complementar do vereador Roberto Bisoni. Ele alega que os pequenos comerciantes estão fadados a fechar as portas, porque, sem a possibilidade de rebaixar as calçadas, os clientes não têm onde estacionar e, por consequência, não param no estabelecimento.O presidente da CDL, Carlos Grendene, comentou que é preciso ter uma definição logo, pois já se passaram várias décadas e nada foi definido concretamente.O Poder Executivo, representado na audiência pela Fundação IPPUJ e pelo ITTRAN, abordou aspectos da lei em vigor e como é feita a fiscalização. Hoje, somente é permitido o rebaixo em um espaço pequeno para saída e outro para entrada, sob justificativa de provimento de mais segurança para os pedestres.O debate gerou um debate sobre a falta de fiscalização, uma vez que, segundo o vereador Bisoni, mais de 80% dos estabelecimentos têm alguma irregularidade. Tal argumento foi apoiado pelos vários comerciantes que participaram das discussões.“É preciso analisar o impacto dessa proposta de forma ampla, não só olhando lado do comerciante, mas também dos pedestres, dos portadores de deficiência, da fiscalização do município, e chegar a um ponto que seja a melhor solução para longo prazo, ainda que se não seja possível atender a todos ao mesmo tempo”, afirmou o vereador Manoel Francisco Bento, que já apresentou uma emenda ao projeto.Na opinião do representante do Conselho Municipal dos Direitos da Pessoa com Deficiência de Joinville (Comde), Sérgio Luiz da Silva, já há lei federal que aborda o assunto e que veda o rebaixamento completo do meio-fio. “Se isso ocorrer em Joinville, vamos iniciar uma batalha judicial contra o município, porque não é sensato que ignoremos solemente uma lei maior”, advertiu.Além disso, o argumento do Comde veio no sentido de que o rebaixamento, ainda que não dificulte o acesso das pessoas, aumentará os riscos de colisões dos automóveis em marcha à ré com os cadeirantes ou as crianças que estiverem passando, uma vez que suas alturas dificultariam a observação pelo retrovisor; questão de segurança.O encontro serviu para que a opinião popular pudesse guiar os vereadores das comissões de Legislação e de Urbanismo rumo a um parecer favorável ou contrário. Ainda que divergentes, especialmente entre comerciantes e Comde, a tendência é de aprovação, uma vez que está acostado ao projeto um abaixo-assinado com cerca de 2.000 assinaturas de apoio. Ainda não há data para sua deliberação em plenário da Câmara de Vereadores de Joinville. Fonte: Ascom CDL\n   ";
	}
}
